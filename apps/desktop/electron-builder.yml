appId: com.nexopos.app
productName: NexoPOS
copyright: Copyright © 2024

# Nombre del instalador con guiones (compatible con electron-updater)
artifactName: "${productName}-Setup-${version}.${ext}"

directories:
  output: release
  buildResources: build

files:
  - dist/electron/**/*
  - dist/renderer/**/*
  - dist/scripts/**/*
  - build/**/*
  - package.json

extraResources:
  - from: electron/setup
    to: setup
  - from: ../backend/dist-bundle
    to: backend/dist
    filter:
      - "**/*"
      - "!**/*.map"
  # Copiar node_modules con exclusiones agresivas para reducir archivos
  - from: ../../node_modules
    to: backend/node_modules
    filter:
      - "**/*"
      # ========================================
      # ARCHIVOS INNECESARIOS (reducen cantidad de archivos)
      # ========================================
      - "!**/*.md"
      - "!**/*.markdown"
      - "!**/*.txt"
      - "!**/README*"
      - "!**/readme*"
      - "!**/CHANGELOG*"
      - "!**/changelog*"
      - "!**/HISTORY*"
      - "!**/history*"
      - "!**/LICENSE*"
      - "!**/license*"
      - "!**/LICENCE*"
      - "!**/licence*"
      - "!**/AUTHORS*"
      - "!**/CONTRIBUTORS*"
      - "!**/.npmignore"
      - "!**/.gitignore"
      - "!**/.gitattributes"
      - "!**/.editorconfig"
      - "!**/.eslintrc*"
      - "!**/.prettierrc*"
      - "!**/tsconfig*.json"
      - "!**/tslint.json"
      - "!**/.travis.yml"
      - "!**/appveyor.yml"
      - "!**/.circleci/**"
      - "!**/.github/**"
      - "!**/docs/**"
      - "!**/doc/**"
      - "!**/test/**"
      - "!**/tests/**"
      - "!**/spec/**"
      - "!**/specs/**"
      - "!**/__tests__/**"
      - "!**/__mocks__/**"
      - "!**/example/**"
      - "!**/examples/**"
      - "!**/coverage/**"
      - "!**/*.map"
      - "!**/*.ts"
      - "!**/*.tsx"
      - "!**/*.d.ts"
      # ========================================
      # Excluir definiciones de tipos
      # ========================================
      - "!**/@types/**"
      # ========================================
      # Excluir paquetes del workspace
      # ========================================
      - "!**/@sistema/**"
      # ========================================
      # Excluir librerias de frontend (no usadas en backend)
      # ========================================
      - "!**/react/**"
      - "!**/react-dom/**"
      - "!**/react-redux/**"
      - "!**/react-router/**"
      - "!**/react-router-dom/**"
      - "!**/react-hook-form/**"
      - "!**/@vitejs/**"
      - "!**/vite/**"
      - "!**/@radix-ui/**"
      - "!**/lucide-react/**"
      - "!**/recharts/**"
      - "!**/framer-motion/**"
      - "!**/tailwindcss/**"
      - "!**/postcss/**"
      - "!**/autoprefixer/**"
      - "!**/cmdk/**"
      - "!**/sonner/**"
      - "!**/next-themes/**"
      - "!**/zustand/**"
      - "!**/immer/**"
      - "!**/redux/**"
      - "!**/@reduxjs/**"
      - "!**/@tanstack/**"
      - "!**/class-variance-authority/**"
      - "!**/clsx/**"
      - "!**/tailwind-merge/**"
      # ========================================
      # Excluir herramientas de desarrollo y build
      # ========================================
      - "!**/typescript/**"
      - "!**/ts-node/**"
      - "!**/ts-node-dev/**"
      - "!**/ts-loader/**"
      - "!**/ts-jest/**"
      - "!**/eslint/**"
      - "!**/@eslint/**"
      - "!**/@typescript-eslint/**"
      - "!**/eslint-plugin-react/**"
      - "!**/eslint-plugin-react-hooks/**"
      - "!**/jest/**"
      - "!**/@jest/**"
      - "!**/vitest/**"
      - "!**/@vitest/**"
      - "!**/webpack/**"
      - "!**/webpack-cli/**"
      - "!**/@webpack-cli/**"
      - "!**/webpack-node-externals/**"
      - "!**/copy-webpack-plugin/**"
      - "!**/babel/**"
      - "!**/@babel/**"
      - "!**/prettier/**"
      - "!**/nodemon/**"
      - "!**/rimraf/**"
      - "!**/turbo/**"
      - "!**/turbo-windows-64/**"
      # ========================================
      # Excluir electron-builder (ya se uso)
      # ========================================
      - "!**/electron-builder/**"
      - "!**/electron-builder-squirrel-windows/**"
      - "!**/app-builder-bin/**"
      - "!**/app-builder-lib/**"
      - "!**/7zip-bin/**"
      - "!**/builder-util/**"
      - "!**/builder-util-runtime/**"
      - "!**/dmg-builder/**"
      - "!**/electron-publish/**"
      # ========================================
      # Excluir frameworks no usados
      # ========================================
      - "!**/@angular/**"
      - "!**/vue/**"
      - "!**/svelte/**"
      - "!**/preact/**"
      # ========================================
      # Binarios de otras plataformas
      # ========================================
      - "!**/android/**"
      - "!**/ios/**"
      - "!**/darwin/**"
      - "!**/linux/**"
      - "!**/*-linux-*/**"
      - "!**/*-darwin-*/**"
      - "!**/*-arm64*/**"
      - "!**/.bin/**"

win:
  target:
    - target: nsis
      arch:
        - x64
  icon: build/icon.ico
  requestedExecutionLevel: asInvoker

nsis:
  oneClick: false
  allowToChangeInstallationDirectory: false
  installerIcon: build/icon.ico
  uninstallerIcon: build/icon.ico
  installerHeaderIcon: build/icon.ico
  createDesktopShortcut: true
  createStartMenuShortcut: true
  shortcutName: NexoPOS
  runAfterFinish: true
  installerLanguages:
    - es_ES
    - en_US

publish:
  - provider: github
    owner: AgustinAlbonico
    repo: sistema-gestion
    releaseType: release

asar: true
asarUnpack:
  - "**/*.node"
  - "**/node_modules/puppeteer/**/*"

# Compresión 'store' = sin compresión = instalación MUCHO más rápida
# El instalador será más grande pero la instalación será instantánea
compression: store

# Deshabilitar differential package para evitar procesamiento extra
npmRebuild: false
